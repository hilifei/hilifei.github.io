var Main=function(e){function t(){e.call(this),new Sample_360}__extends(t,e);var i=(__define,t);return p=i.prototype,t}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var SampleBase=function(){function e(){var e=this;this._removeID=-1,this._resizeTime=-1,this.initView(),egret3d.AssetsManager.getInstance().addEventListener(egret3d.Event3D.EVENT_LOAD_PROGRESS,function(t){return e.progress(t)})}var t=(__define,e);return p=t.prototype,p.resize=function(){var e=this;-1==this._resizeTime&&(this._resizeTime=setTimeout(function(){return e.setResize()},300))},p.onResize=function(e,t,i,n){},p.setResize=function(){clearTimeout(this._resizeTime),this._resizeTime=-1,this.onResize(0,0,document.body.clientWidth,document.body.clientHeight),this.resizeUI()},p.progress=function(e){var t=document.getElementById("loading"),i=document.getElementById("loadingtiao"),n=egret3d.AssetsManager.getInstance().loadCompleteNumber/egret3d.AssetsManager.getInstance().loadTotalNumber,r=Math.floor(100*n),o=Math.floor(t.clientWidth*n);document.getElementById("percent").innerHTML="Loading......"+(r>100?100:r)+"% ......",i.style.width=(o>t.clientWidth?t.clientWidth:o)+"px"},p.remove=function(){clearTimeout(this._removeID);var e=document.getElementById("mask");document.body.style.backgroundColor="#000000",document.body.removeChild(e)},p.resizeUI=function(){var e=document.body.clientWidth,t=document.getElementById("mask");if(t){var i=document.getElementById("loading");i.style.width=.5*e+"px",i.style.top="40%",i.style.left=.5*(e-.5*e)+"px"}},p.initView=function(){var e=document.body.clientWidth,t=document.createElement("div");t.id="mask",t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="#545454",t.style.zIndex="100",document.body.appendChild(t);var i=document.createElement("div");i.id="loading",i.style.position="absolute",i.style.width=.5*e+"px",i.style.top="40%",i.style.left=.5*(e-.5*e)+"px",document.body.style.backgroundColor="#545454",t.appendChild(i);var n=document.createElement("img");n.src="resource/logo.png",n.style.position="absolute",n.style.left=.5*(i.clientWidth-85)+"px";var r=document.createElement("div");r.id="loadingcao",r.style.borderRadius="15px 15px 15px 15px",r.style.backgroundColor="#404040",r.style.width=i.clientWidth+"px",r.style.height="5px",r.style.position="absolute",r.style.top="100px";var o=document.createElement("div");o.id="loadingtiao",o.style.borderRadius="15px 15px 15px 15px",o.style.backgroundColor="#ffffff",o.style.height="5px",o.style.position="absolute",o.style.top="100px";var s=150,a=document.createElement("div");a.id="percent",a.style.width=s+"px",a.style.color="#000000",a.style.position="absolute",a.style.left=.5*(i.clientWidth-s)+"px",a.style.top="140px",a.style.textShadow="#fff 1px 0 2px,#fff 0 1px 2px,#fff -1px 0 2px,#fff 0 -1px 2px",i.appendChild(r),i.appendChild(o),i.appendChild(n),i.appendChild(a)},e}();egret.registerClass(SampleBase,"SampleBase");var Sample_360=function(e){function t(){var t=this;e.call(this),this.time=0,this.delay=0,this._viewPort=new egret3d.Rectangle(0,0,document.body.clientWidth,document.body.clientHeight),egret3d.Egret3DDrive.requstContext3D(DeviceUtil.getGPUMode,this._viewPort,function(){return t.init3D()})}__extends(t,e);var i=(__define,t);return p=i.prototype,p.onResize=function(e,t,i,n){this._view3D.resize(e,t,i,n)},p.init3D=function(){var t=this;egret3d.CheckerboardTexture.texture.upload(egret3d.Egret3DDrive.context3D),this._view3D=new egret3d.View3D(this._viewPort),window.addEventListener("resize",function(){return e.prototype.resize.call(t)}),this._view3D.camera3D.position=new egret3d.Vector3D(0,5,-10),egret3d.AssetsManager.getInstance().setRootURL("resource/"),egret3d.AssetsManager.getInstance().addLoadTexture("360photo/2.JPG"),egret3d.AssetsManager.getInstance().addEventListener(egret3d.Event3D.EVENT_LOAD_COMPLETE,function(e){return t.initScene(e)}),egret3d.AssetsManager.getInstance().startLoad()},p.initScene=function(t){var i=this;setTimeout(e.prototype.remove,1e3);var n=egret3d.AssetsManager.getInstance().findTexture("360photo/2.JPG"),r=new egret3d.TextureMaterial(n);r.ambientPower=.5;var o=new egret3d.Mesh(new egret3d.SphereGeometry(200,45,45),r);r.cullMode=egret3d.Egret3DDrive.FRONT,this._view3D.addChild3D(o),this._cameraController=new egret3d.HoverController(this._view3D.camera3D),this._cameraController.steps=12,window.requestAnimationFrame(function(){return i.update()})},p.update=function(){var e=this;this.timeDate=new Date,this.delay=this.timeDate.getTime()-this.time,this.time=this.timeDate.getTime(),this._cameraController.update(),this._view3D.renden(this.time,this.delay),window.requestAnimationFrame(function(){return e.update()})},t}(SampleBase);egret.registerClass(Sample_360,"Sample_360");